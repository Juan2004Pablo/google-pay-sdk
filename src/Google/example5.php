<?php

// PRUEBA 5 , POR FAVOR QUE FUNCIONE DIOSITO

// Solo desencriptar el mensaje

// Parámetros de entrada (sólo usa las cadenas tal como son en formato binario)
$symmetric_encryption_key = "\x8b\xa5\xec\x96\xba\xa4rs\xac\xd1\xd7d\x064\xa2v\xe3\xba\xae\xa8l\xd3\x8e\xba\x17\xbf\x1b\x97\x1al\xa0B";
$encrypted_message = "\x7d\xae\xae\xcc\x4d\xb3\x93\xad\xae\x5c\x9e\xa7\x55\xf8\xab\xf8\x49\xf0\xf4\x61\x93\x29\x33\x8b\x07\x24\xea\x4a\xfb\xe6\x4c\x9f\x8c\xa2\xde\x9a\xa9\xe5\x36\x02\xda\x96\xa7\x5c\x5f\xad\xff\xf0\x83\x9e\x37\x54\xd9\x33\x8a\x96\xf3\xe0\x4a\xf1\x3a\x1a\x85\xeb\xad\x26\x4d\x43\xce\xc5\x46\x9a\x84\x61\xa3\xd9\x4b\x9b\x5a\x0e\x0a\x6b\x35\xd5\xd2\xe2\x16\xb8\x15\x17\x38\x91\xbd\xab\x54\xc7\x6f\xe7\x04\xf5\x4b\x03\x1a\xb8\x9a\xf1\xc2\x88\x00\x91\x23\x6e\xe2\x75\xcc\x54\x73\x16\x5b\xee\x37\xe2\xe8\x4a\x32\xca\x3e\xe1\xf3\xd3\x7a\xb5\xcc\x7a\x64\xab\x04\x0b\x8e\x5d\xff\x78\x42\xa3\x6d\x79\x10\x0f\x16\xd6\x85\x41\x3c\xef\x87\x3e\x48\x0a\x87\xfc\x75\xfa\x21\x74\x5a\x91\x34\x31\x50\x22\x08\x17\x10\x0c\xc1\x8d\x89\x89\x30\x55\x08\xae\x3f\xd7\x5c\xa8\x7f\xfd\x87\xd4\x19\x44\x4f\x34\x43\xc3\x47\xf4\x27\x77\xfc\xbd\x18\xb4\x5c\xe7\xb4\x6c\x07\x97\x7f\x74\xc7\x9e\x05\x81\x8c\x42\xa8\x7f\x5e\xdb\x13\x69\xf2\x94\x36\x59\xdc\x86\xc8\x0a\xd9\x4d\x36\x9e\xeb\xa8\x1e\x48\x51\xbb\x51\x40\x62\x45\x35\x45\xbd\x3a\xfe\xf4\x8e\x66\x2a\x7a\x73\x17\x73\x5c\xde\x75\xb7\xa9\x9f\x7d\xff\x0f\x40\xe2\x2e\xde\xcf\xc9\x03\x21\x20\x03\x2f\x71\xd7\x40\xbb\x08\x8e\xf9\x45\x10\x13\xd3\x63\xe8\x6f\xb3\x22\xd2\xac\xba\xf6\xb9\xa7\x94\x1a\xb9\x51\xeb\xa3\xe1\x03\x9c\xc7\x9e\xbb\x13\x6d\xe7\x1b\x5b\x81\xe8\x90\x10\xa0\x2b\x86\xf4\x7a\x83\x64\x1d\x63\xc4\x36\xac\xd9\xee\xe0\x53\x82\x6d\x94\xe1\x35\xe2\xbb\xb3\xba\x07\x64\x45\xe0\x47\x36\x3e\x5d\x69\xb5\x07\x02\x92\x48\xbe\x19\xe3\x4e\xec\xc1\xff\xbe\x0a\x6c\x00\xd6\x0c\xd7\xd0\x5c\x00\xd2\x9a\x13\xb8\x25\x90\xb6\x90\xe5\x05\x27\xf2\xc7\x32\xfd\xf1\x52\x3f\x03\x6d\x37\x92\x19\x17\xc7\x81\x10\x28\xaa\x31\x9c\xba\x0c\xfc\x01\x76\x59\x30\xa8\x56\xf9\x80";

// Inicializar IV a 16 bytes de ceros, ya que en el código original no hay un IV explícito
$iv = str_repeat("\0", 16);

// Desencriptar el mensaje usando AES-256-CTR
$decrypted_message = openssl_decrypt(
    $encrypted_message,
    'aes-256-ctr',
    $symmetric_encryption_key,
    OPENSSL_RAW_DATA,
    $iv
);

// Mostrar el mensaje desencriptado
echo "Mensaje desencriptado: " . $decrypted_message . PHP_EOL;
